' Import required libraries
Imports System
Imports Amazon
Imports Amazon.S3
Imports Amazon.S3.Transfer

' Define function to upload file to S3
Function UploadFileToS3(bucketName, s3Filename, tempFilePath)
    On Error Resume Next ' Enable error handling
    UploadFileToS3 = False ' Default return value to indicate failure

    ' Create an Amazon S3 client
    Dim client
    Set client = CreateObject("Amazon.S3.AmazonS3Client")
    client.Config.RegionEndpoint = RegionEndpoint.USEast1 ' Specify your region

    If Err.Number <> 0 Then
        MsgBox "Error creating S3 client: " & Err.Description
        Exit Function
    End If

    ' Upload the file to S3
    Dim transferUtility
    Set transferUtility = New TransferUtility(client)
    transferUtility.Upload(tempFilePath, bucketName, s3Filename)

    If Err.Number <> 0 Then
        MsgBox "Error uploading file to S3: " & Err.Description
    Else
        UploadFileToS3 = True ' Set return value to indicate success
    End If
End Function

' Main script
Sub Main()
    ' Define S3 bucket and S3 filename
    Dim s3Bucket
    s3Bucket = "your-s3-bucket-name"
    Dim s3Filename
    s3Filename = "path/to/rallyTCresults.json"

    ' Define the path to the existing temp file
    Dim tempFilePath
    tempFilePath = "C:\VV\tempFile.json"

    ' Call function to upload file to S3
    Dim uploadResult
    uploadResult = UploadFileToS3(s3Bucket, s3Filename, tempFilePath)

    ' Print upload result
    If uploadResult Then
        MsgBox "File uploaded successfully."
    Else
        MsgBox "Failed to upload file."
    End If
End Sub

' Call the main script
Main()
