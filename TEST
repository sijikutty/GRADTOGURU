' Import required libraries
Imports System
Imports Amazon
Imports Amazon.S3
Imports Amazon.S3.Transfer

' Define function to upload file to S3
Function UploadFileToS3(bucketName, s3Filename, tempFilePath)
    Try
        ' Create an Amazon S3 client
        Dim region
        Set region = RegionEndpoint.USEast1 ' Specify your region
        Dim client
        Set client = New AmazonS3Client(region)

        ' Upload the file to S3
        Dim request
        Set request = New TransferUtilityUploadRequest()
        request.BucketName = bucketName
        request.FilePath = tempFilePath
        request.Key = s3Filename
        Dim utility
        Set utility = New TransferUtility(client)
        utility.Upload(request)

        ' Return success
        UploadFileToS3 = True

    Catch ex
        ' Handle exceptions
        UploadFileToS3 = False
        MsgBox "Error: " & ex.Message
    End Try
End Function

' Main script
Sub Main()
    ' Define S3 bucket and S3 filename
    Dim s3Bucket
    s3Bucket = "your-s3-bucket-name"
    Dim s3Filename
    s3Filename = "path/to/rallyTCresults.json"

    ' Define the path to the existing temp file
    Dim tempFilePath
    tempFilePath = "C:\VV\tempFile.json"

    ' Call function to upload file to S3
    Dim uploadResult
    uploadResult = UploadFileToS3(s3Bucket, s3Filename, tempFilePath)

    ' Print upload result
    If uploadResult Then
        MsgBox "File uploaded successfully."
    Else
        MsgBox "Failed to upload file."
    End If
End Sub

' Call the main script
Main()
