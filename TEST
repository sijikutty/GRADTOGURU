target_folder = 'data'  # Subfolder name to search for

# Function to recursively search for a folder
def search_for_folder(sftp, current_directory, target_folder):
    try:
        # Change directory to the current directory
        sftp.chdir(current_directory)

        # List all items (files and directories) in the current directory
        items = sftp.listdir()

        for item in items:
            # Check if the item is a directory
            if sftp.stat(item).st_mode // 32768 == 1:  # Directory check
                if item == target_folder:
                    return True
                else:
                    # Recursively search within this directory
                    if search_for_folder(sftp, f"{current_directory}/{item}", target_folder):
                        return True

        return False

    except FileNotFoundError:
        return False

    except Exception as e:
        print(f"Error searching for folder in {current_directory}: {str(e)}")
        return False

# Create an SSH client instance
ssh_client = paramiko.SSHClient()
ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

try:
    # Connect to the SSH server using password authentication
    ssh_client.connect(hostname=hostname, username=username, password=password)

    # Open an SFTP session on the SSH connection
    sftp = ssh_client.open_sftp()

    # Check if the target folder exists anywhere
    if search_for_folder(sftp, "/", target_folder):
        print(f"Subfolder '{target_folder}' exists in at least one directory on the server.")
    else:
        print(f"Subfolder '{target_folder}' does not exist in any directory on the server.")

finally:
    # Close the SFTP session and SSH connection
    if ssh_client:
        ssh_client.close()
