from playwright.sync_api import sync_playwright

def check_selected_options(page):
    # Locate the iframe containing the target content
    iframe = page.frame_locator("iframe[name='TargetContent']")

    # Locate all rows in the table (adjust the selector as needed)
    rows = iframe.locator("tr").all()

    # Check the number of rows found
    print(f"Number of rows found: {len(rows)}")

    for index in range(len(rows)):
        # Use the index to build the selector for the select element
        select = iframe.locator(f"[id='CURR_STP_TGTF_FIELDNAME\\${index + 1}']")

        # Check if the select element exists in the current row
        if select.count() > 0:
            # Get the currently selected option
            selected_option = select.input_value()  # or use select.selected_option() for more details
            
            # Check if the selected option matches "BOOK_CODE"
            if selected_option == "BOOK_CODE":
                print(f"Row {index + 1}: 'BOOK_CODE' is selected.")
            else:
                print(f"Row {index + 1}: Selected option is '{selected_option}'.")
        else:
            print(f"Row {index + 1}: No select element found.")

# Example usage
with sync_playwright() as p:
    browser = p.chromium.launch()
    page = browser.new_page()
    
    # Navigate to the page containing the iframe
    page.goto('YOUR_PAGE_URL')

    # Call the function to check selected options
    check_selected_options(page)

    # Close the browser
    browser.close()
