import cx_Oracle
import oracledb  # Make sure this is the correct import for cx_Oracle

def connect_to_oracleDB(secretID):
    db_secrets = get_DBsecrets(secretID)

    try:
        print("Connecting to DB")
        connection = cx_Oracle.connect(user=db_secrets['username'],
                                       password=db_secrets['password'],
                                       dsn=f"{db_secrets['host']}:{db_secrets['port']}/{db_secrets['servicename']}")

        print("Database connected successfully")
        cursor = connection.cursor()

        # Example query
        query = "SELECT COUNT(*) FROM PS_JRNL_HEADER WHERE SOURCE = 'MAX'"

        cursor.execute(query)
        row = cursor.fetchone()
        count = row[0]  # Assuming COUNT(*) returns a single value

        print(f"Result of the query: {count}")

        cursor.close()
        connection.close()

        return {"status": True, "count": count}

    except cx_Oracle.Error as e:
        print(f"ORACLE Error: {e}")
        return {"status": False, "error": str(e)}
