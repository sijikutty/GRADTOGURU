import boto3
import sys
import json

def upload_to_s3(json_file_path, bucket_name, s3_file_name):
    # Initialize S3 client
    s3 = boto3.client('s3')

    # Read JSON data from file
    with open(json_file_path, 'r') as file:
        json_data = json.load(file)

    # Upload JSON data to S3 bucket
    s3.put_object(
        Bucket=bucket_name,
        Key=s3_file_name,
        Body=json.dumps(json_data).encode('utf-8')
    )

if __name__ == "__main__":
    # Get JSON file path, bucket name, and S3 filename from command line arguments
    json_file_path = sys.argv[1]
    bucket_name = sys.argv[2]
    s3_file_name = sys.argv[3]

    # Upload JSON data to S3
    upload_to_s3(json_file_path, bucket_name, s3_file_name)
-----------
Dim json_file_path, bucket_name, s3_file_name, python_script_path
json_file_path = "C:\path\to\your\json_file.json"  ' Set the JSON file path
bucket_name = "your-bucket-name"                   ' Set the S3 bucket name
s3_file_name = "your_s3_filename.json"             ' Set the S3 filename
python_script_path = "C:\path\to\your\python_script.py"  ' Set the path to your Python script

' Execute the Python script using SystemUtil.Run
SystemUtil.Run "python", """" & python_script_path & """ """ & json_file_path & """ """ & bucket_name & """ """ & s3_file_name & """", "", output
