# Locate all frames with IDs starting with 'ptModFrame'
frames = page.locator("[id^='ptModFrame']")

# Count the number of frames
frame_count = frames.count()
print(f"Number of frames with ID starting with 'ptModFrame': {frame_count}")

# Interact with frames to find the "Run" button
for index in range(frame_count):
    frame = frames.nth(index)

    # Check if the "Run" button exists within a cell
    if frame.locator("cell[name='Run']").is_visible():
        frame.locator("cell[name='Run']").locator("a").click()  # Click the link within the cell
        page.get_by_role("button", name="Yes").click()  # Confirm if necessary
        break  # Exit the loop after clicking "Run"

# Interact with a specific frame for "Server Name"
if frame_count > 2:  # Ensure the third frame exists
    popup_dialog = frames.nth(2)  # Change index based on your needs
    popup_dialog.get_by_label("Server Name").select_option("PSUNX")
    popup_dialog.get_by_role("button", name="OK", exact=True).click()
