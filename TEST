import paramiko

# SSH connection details
hostname = 'example.com'
username = 'your_username'
password = 'your_password'  # Replace with your actual password
directory_to_enter = 'ora'  # The directory you want to enter

# Function to recursively list directories
def list_directories(ssh_client, current_directory):
    # Send the command to list files and directories in the current directory
    ssh_shell.send(f'cd {current_directory}\n')
    ssh_shell.send('ls -l -d */\n')  # List only directories (ending with '/')

    # Wait for the command to execute
    while not ssh_shell.recv_ready():
        pass

    # Read and print the output of the command
    output = ssh_shell.recv(65535).decode()

    # Extract directory names from the output
    dir_names = [line.split()[0].strip('/') for line in output.splitlines()]

    # Print the directory names
    print(f"Subdirectories in '{current_directory}':")
    for dir_name in dir_names:
        print(dir_name)

    # Recursively list contents of each subdirectory
    for dir_name in dir_names:
        list_directories(ssh_client, f"{current_directory}/{dir_name}")

# Create an SSH client instance
ssh_client = paramiko.SSHClient()
ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

try:
    # Connect to the SSH server using password authentication
    ssh_client.connect(hostname=hostname, username=username, password=password)

    # Create an interactive shell session
    ssh_shell = ssh_client.invoke_shell()

    # Call the function to list directories recursively starting from 'ora'
    list_directories(ssh_client, directory_to_enter)

finally:
    # Close the SSH connection
    ssh_client.close()
