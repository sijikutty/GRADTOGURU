
TCName="hi"
TCID="11"
verdict="Pass"
result="Pass"

	Dim fs, outFile, jsonContent, jsonData
	'Time format
	' Get the current date and time
	current_datetime = Now
	
	' Format the date and time to a string
	formatted_datetime = Year(current_datetime) & "-" & Right("0" & Month(current_datetime), 2) & "-" & Right("0" & Day(current_datetime), 2) & "T" & Right("0" & Hour(current_datetime), 2) & ":" & Right("0" & Minute(current_datetime), 2) & ":" & Right("0" & Second(current_datetime), 2)
	
	' Get the microseconds part
	microseconds = Right(FormatNumber((current_datetime - Int(current_datetime)) * 1000000, 6), 6)
	
	' Concatenate microseconds to the formatted string
	formatted_datetime_with_microseconds = formatted_datetime & "." & microseconds
	' Create an instance of the Environment object

	Dim env
	Set env = CreateObject("WScript.Shell").Environment("Process")
	' Retrieve the user's profile directory (home directory)
	Dim homeDir
	homeDir = env("USERPROFILE")
	Set Dom = jsonutil.Parse(homeDir & "\.secret\credentials.json")
	Set rally = Dom.GetArray("rally")
	For Each object in rally
	    server = object.getValue("server")
	    user = object.getValue("user")
	    apikey = object.getValue("apikey")
	    workspace = object.getValue("workspace")
	    project = object.getValue("project")
	    envr = object.getValue("envr")

	    Exit For
	Next

	' Create a dictionary to hold the data
	Set jsonContent = CreateObject("Scripting.Dictionary")
	jsonContent.Add "key",TCName
	        'jsonContent.Add "Rally"
	      '  jsonContent.Add ": {"
	Set rallyContent = CreateObject("Scripting.Dictionary")
	rallyContent.Add "server", server
	rallyContent.Add "user", user
	rallyContent.Add "apikey", apikey
	rallyContent.Add "workspace", workspace
	rallyContent.Add "project", project
	rallyContent.Add "Tcid", TCID
	rallyContent.Add "build",(envr & "-Automated Run")
	rallyContent.Add "run_date", formatted_datetime_with_microseconds
		rallyContent.Add "verdict", verdict
		rallyContent.Add "notes", result
	
	' Convert dictionary to JSON-like string
	'jsonData = "{"
	'For Each key In jsonContent.Keys
	   ' jsonData = jsonData & """" & key & """:""" & jsonContent(key) & ""","
	'Next
	'jsonData = Left(jsonData, Len(jsonData) - 1) ' Remove the trailing comma
	'jsonData = jsonData & "}}"
		jsonData = "{"
	For Each key In jsonContent.Keys
		Msgbox key
	    If key = "key" Then
	    	
	        jsonData = jsonData & """Rally"":{"
	        For Each innerKey In rallyContent.Keys
	        Msgbox "hello"
	            jsonData = jsonData & """" & innerKey & """:""" & rallyContent(innerKey) & ""","
	        Next
	        jsonData = Left(jsonData, Len(jsonData) - 1) ' Remove the trailing comma
	        jsonData = jsonData & "},"
	    Else
	    	Msgbox "hi"
	        jsonData = jsonData & """" & key & """:""" & jsonContent(key) & ""","
	    End If
	Next
	jsonData = Left(jsonData, Len(jsonData) - 1) ' Remove the trailing comma
	jsonData = jsonData & "}}"
	
	' Specify the file path
	filePath = "C:\Github\corp_corpit_ps_egl_test_automation\UFT\rallydata.json"
	
	' Create FileSystemObject
	Set fs = CreateObject("Scripting.FileSystemObject")
	
	' Create or overwrite the file
	Set outFile = fs.CreateTextFile(filePath, True)
	
	' Write JSON content to the file
	outFile.WriteLine(jsonData)
	
	' Close the file
	outFile.Close
	
	' Release objects
	Set outFile = Nothing
	Set fs = Nothing
	
	'WScript.Echo "Data written to JSON file successfully."
---
i want {"key":"Smoketest for FAH Concurrent Program",{"Rally":{"server":"rally1.rallydev.com","user":"siji.mallisserykalam@thehartford.com","apikey":"_lLETAuRTnC0Nth0Nvcz6iQHOvKr0EaFigCvGXr7r4","workspace":"Corporate IT","project":"IT Finance IGNITE","Tcid":"TC32547","build":"dev-Automated Run","run_date":"2024-05-08T19:06:36.999999","verdict":"Pass","notes":"Test is success"}}

but its coming as:
{"Rally":{"server":"rally1.rallydev.com","user":"siji.mallisserykalam@thehartford.com","apikey":"_lLETAuRTnC0Nth0Nvcz6iQHOvKr0EaFigCvGXr7r4","workspace":"Corporate IT","project":"IT Finance IGNITE","Tcid":"TC32547","build":"dev-Automated Run","run_date":"2024-05-08T19:06:36.999999","verdict":"Pass","notes":"Test is success"}}}
