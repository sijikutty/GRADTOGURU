' Function to launch the Microsoft Edge browser
Function Launch()
    ' Close existing instances of Microsoft Edge and Java Platform Launcher
    SystemUtil.CloseProcessByName("msedge.exe")
    SystemUtil.CloseProcessByName("jp2launcher.exe")
    ' Run Microsoft Edge browser
    SystemUtil.Run "msedge.exe"
End Function

' Function to retrieve credentials from a JSON file and launch the application
Function Credentials()
    ErrorHandling
    ' Retrieve the user's profile directory (home directory)
    Dim homeDir
    homeDir = CreateObject("WScript.Shell").Environment("Process")("USERPROFILE")
    ' Parse the credentials from the JSON file
    Set Dom = jsonutil.Parse(homeDir & "\.secret\credentials.json")
    Set users = Dom.GetArray("fahuser")
    For Each user in users
        fahusername = user.getValue("fahusername")
        fahpassword = user.getValue("fahpassword")
        Exit For
    Next
    ' Launch the application with the retrieved credentials
    fahLaunch fahusername, fahpassword
End Function

' Function to launch the application with the provided credentials
Function fahLaunch(fahusername, fahpassword)
    ErrorHandling
    ' Wait till browser loads completely
    Browser("iConnect - Home").Page("iConnect - Home").Sync
    ' Navigate to the specified URL
    Browser("iConnect - Home").Navigate "http://p2808hldebz002.thehartford.com:8005/OA_HTML/AppsLocalLogin.jsp"
    ' Set username and password
    Browser("iConnect - Home").Page("Login").WebEdit("usernameField").Set fahusername
    Browser("iConnect - Home").Page("Login").WebEdit("passwordField").Set fahpassword
    ' Click on the Log In button
    Browser("iConnect - Home").Page("Login").WebButton("Log In").Click
End Function

' Function to run a request in the application
Function fahRunRequest()
    ErrorHandling
    ' Navigate to the desired page
    Browser("iConnect - Home").Page("Home").Link("XXHIG Custom").Click
    Browser("iConnect - Home").Page("Home").Link("Run Requests").Click
    ' Handle Security Warning dialog if it appears
    If JavaDialog("Security Warning").Exist(10) Then
        JavaDialog("Security Warning").JavaCheckBox("I accept the risk and").Set "ON"
        JavaDialog("Security Warning").JavaButton("Run").Click
    End If
    ' Perform actions to run the request
    ' ...
End Function

' Function to check if a request is completed
Function CheckCompleted()
    ErrorHandling
    ' Check if the request is completed
    ' ...
End Function

' Function to view run details and report test results
Function ViewRunDetails()
    ErrorHandling
    ' View run details and report test results
    ' ...
End Function

' Function to write test results to UFT One
Function WriteToUFTOne(result)
    If result = "Test is success" Then
        Reporter.ReportEvent micPass, "Test Result", result
    Else
        Reporter.ReportEvent micFail, "Test Result", result
    End If
End Function

' Function for error handling
Function ErrorHandling()
    If Err.Number <> 0 Then
        ' Handle errors
        ' ...
        ' Clean up and exit
        ' ...
    End If
End Function

' Function to close application windows and browsers
Function CloseWindows()
    ErrorHandling
    ' Close application windows and browsers
    ' ...
End Function

' Main subroutine to run the test
Sub Main()
    On Error Resume Next
    ' Perform test steps
    Launch
    Credentials
    fahRunRequest
    ViewRunDetails
    CloseWindows
    ErrorHandling
End Sub

' Call the main subroutine to start the test
Main
