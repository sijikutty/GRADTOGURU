' Close existing instances of Microsoft Edge and Java Platform Launcher
SystemUtil.CloseProcessByName("msedge.exe")
SystemUtil.CloseProcessByName("jp2launcher.exe")

' Run Microsoft Edge browser
SystemUtil.Run "msedge.exe"

' Define variable for the iConnect home page
Dim iConnectHomePage
Set iConnectHomePage = Browser("iConnect - Home").Page("iConnect - Home")

' Define variable for the service operation definitions page
Dim serviceOperationDefinitionsPage
Set serviceOperationDefinitionsPage = Browser("iConnect - Home").Page("Service Operation Definitions")

' Navigate to the iConnect login page
iConnectHomePage.Navigate "http://p2807hldpst001.thehartford.com:8300/psp/fgl2d/?cmd=login&languageCd=ENG&"
iConnectHomePage.WebEdit("userid").Set "PWTEST"
iConnectHomePage.WebEdit("pwd").Set "Pwtest@100"
iConnectHomePage.WebButton("To enable screen reader").Click
iConnectHomePage.Image("NavBar").Click

' Navigate through various pages and perform actions
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").WebButton("PTNB$PTNUI_NB_MENU").Click
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").Link("PeopleTools").Click
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").Link("Integration Broker").Click
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").Link("Integration Setup").Click
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").Link("Service Operation Definitions").Click
serviceOperationDefinitionsPage.Frame("TargetContent").Image("Look up Service").Click
serviceOperationDefinitionsPage.Frame("modWin_0").Link("ACCOUNT_CHARTFIELD_SYNC").Click
serviceOperationDefinitionsPage.Frame("TargetContent").Image("Look up Service Operation").Click
serviceOperationDefinitionsPage.Frame("modWin_1").Link("ACCOUNT_CF_SYNC").Click
serviceOperationDefinitionsPage.Frame("TargetContent").WebElement("WebElement").Click
serviceOperationDefinitionsPage.Frame("TargetContent").Link("ACCOUNT_CF_SYNC").Click
serviceOperationDefinitionsPage.Frame("TargetContent_2").WebCheckBox("PSOPRVERDFN_ACTIVE_FLAG$0").Set "OFF"
serviceOperationDefinitionsPage.Frame("TargetContent_2").WebButton("Save").Click
serviceOperationDefinitionsPage.WebButton("OK").Click
serviceOperationDefinitionsPage.WebButton("pthdr2navbar").Click
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").Image("PTNUI_MENU_ICN_1").Click
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").WebMenu("Breadcrumbs").Select "Menu"
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").Link("Set Up Financials/Supply").Click
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").Link("Common Definitions").Click
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").Link("Design ChartFields").Click
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").Link("Define Values").Click
serviceOperationDefinitionsPage.Frame("psNavBarIFrame").Link("Define ChartField Value").Click
serviceOperationDefinitionsPage.Frame("TargetContent").Link("Account").Click

' Define variables for repeated objects
Dim defineChartFieldValuePage
Set defineChartFieldValuePage = Browser("iConnect - Home").Page("Define ChartField Value").Frame("TargetContent_2")

' Set values and perform actions on the Define ChartField Value page
defineChartFieldValuePage.WebEdit("GL_ACCT_ALL_VW_SETID").Set "SHARE"
defineChartFieldValuePage.WebEdit("GL_ACCT_ALL_VW_ACCOUNT").Set "100000"
defineChartFieldValuePage.WebButton("Search").Click
defineChartFieldValuePage.WebButton("Correct History").Click
defineChartFieldValuePage.WebEdit("GL_ACCOUNT_TBL_DESCR$0").Set "Bnd_TaxEx_PY_Tes_AUTOTEST14"
defineChartFieldValuePage.WebButton("Save").Click
defineChartFieldValuePage.WebButton("pthdr2navbar").Click
defineChartFieldValuePage.Frame("psNavBarIFrame").WebButton("PTNB$PTNUI_NB_MENU").Click
defineChartFieldValuePage.Frame("psNavBarIFrame").WebMenu("Breadcrumbs").Select "Menu"
defineChartFieldValuePage.Frame("psNavBarIFrame").Link("Enterprise Components").Click
defineChartFieldValuePage.Frame("psNavBarIFrame").Link("Integration Definitions").Click
defineChartFieldValuePage.Frame("psNavBarIFrame").Link("Initiate Processes").Click
defineChartFieldValuePage.Frame("psNavBarIFrame").Link("Full Data Publish").Click
defineChartFieldValuePage.WebButton("Search").Click

' Navigate to another URL
Browser("iConnect - Home").Navigate "http://p2808hldebz002.thehartford.com:8005/OA_HTML/AppsLocalLogin.jsp"
Dim loginPage
Set loginPage = Browser("iConnect - Home").Page("Login")
loginPage.WebEdit("usernameField").Set "fitauto"
loginPage.WebEdit("passwordField").SetSecure "6626f303d6a46a06ba97dcdc586347bf274c077780e5f50b0893"
loginPage.WebButton("Log In").Click
Dim homePage
Set homePage = Browser("iConnect - Home").Page("Home")
homePage.Link("Application Developer").Click
homePage.Link("Flexfield").Click
homePage.Link("Key").Click
homePage.Link("Values").Click

' Check if a JavaDialog with the title "Security Warning" exists
If JavaDialog("Security Warning").Exist(10) Then
    ' If it exists, set the checkbox and click the Run button
    JavaDialog("Security Warning").JavaCheckBox("I accept the risk and").Set "ON"
    JavaDialog("Security Warning").JavaButton("Run").Click
End If

' Define variables for Oracle form windows and list of values
Dim findKeyFlexfieldSegmentForm, applicationsList, segmentsList, valuesList
Set findKeyFlexfieldSegmentForm = OracleFormWindow("Find Key Flexfield Segment")
Set applicationsList = OracleListOfValues("Applications")
Set segmentsList = OracleListOfValues("Key Flexfield Segments")
Set valuesList = OracleListOfValues("OracleListOfValues")

' Perform actions on Oracle forms
findKeyFlexfieldSegmentForm.OracleTextField("Application").OpenDialog
applicationsList.Select "General Ledger"
findKeyFlexfieldSegmentForm.OracleTextField("Segment").OpenDialog
segmentsList.Select "Account"
findKeyFlexfieldSegmentForm.OracleTextField("Value").OpenDialog
valuesList.Select "100000"
findKeyFlexfieldSegmentForm.OracleButton("Find").Click
