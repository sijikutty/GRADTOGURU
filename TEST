import win32com.client

def open_excel_and_select_addin():
    xl = win32com.client.Dispatch("Excel.Application")
    xl.Visible = True
    
    xlWB = xl.Workbooks.Open(r"C:\path\to\your\file.xlsx")  # Replace with the path to your Excel file
    
    # Navigate to Add-Ins menu
    xl.CommandBars("Worksheet Menu Bar").Controls("Tools").Controls("Add-Ins...").Execute()
    
    # Select the dropdown of the 'drill' add-in and click on it
    xl.CommandBars("Add-Ins").Controls("drill").Execute()
    # The following line is optional if 'drill' add-in has a submenu
    # xl.CommandBars("Add-Ins").Controls("drill").Controls("drillk").Execute()

if __name__ == "__main__":
    open_excel_and_select_addin()
