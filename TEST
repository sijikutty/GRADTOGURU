import os
from openpyxl import load_workbook

def find_latest_download(folder):
    # Get list of files in the folder
    files = os.listdir(folder)
    # Filter only Excel files
    excel_files = [f for f in files if f.endswith('.xlsx')]
    # Sort files by modification time (newest first)
    excel_files.sort(key=lambda x: os.path.getmtime(os.path.join(folder, x)), reverse=True)
    if excel_files:
        return os.path.join(folder, excel_files[0])
    else:
        return None

def input_data_into_cell(file_path, sheet_name, cell, data):
    try:
        wb = load_workbook(filename=file_path)
        ws = wb[sheet_name]
        ws[cell] = data
        wb.save(file_path)
        print("Data input successful.")
    except Exception as e:
        print("Error occurred while inputting data:", e)

# Replace 'YOUR_DOWNLOAD_FOLDER_PATH' with the path to your browser's download folder
download_folder = 'YOUR_DOWNLOAD_FOLDER_PATH'
latest_file_path = find_latest_download(download_folder)

if latest_file_path:
    print("Latest downloaded file:", latest_file_path)
    sheet_name = 'Sheet1'  # Change to the name of your sheet
    cell = 'A1'            # Change to the cell where you want to input the data
    data = 'Hello, World!' # Change to the data you want to input
    input_data_into_cell(latest_file_path, sheet_name, cell, data)
else:
    print("No Excel file found in the download folder.")
