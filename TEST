' RallyIntegration.vbs

' Function to fetch TestCase from Rally
Function GetTestCase(rally, tc_number)
    On Error Resume Next
    Dim query_criteria, response, tc
    
    ' Construct the query criteria
    query_criteria = "FormattedID = '" & tc_number & "'"
    
    ' Send request to fetch TestCase
    response = rally.get("TestCase", , query_criteria)
    
    ' Check if response is valid
    If IsObject(response) Then
        ' Iterate through the response
        For Each tc In response
            ' Return the first TestCase object found
            Set GetTestCase = tc
            Exit Function
        Next
    End If
    
    ' If no TestCase found, return False
    Set GetTestCase = Nothing
End Function
