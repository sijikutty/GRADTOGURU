import paramiko

# SSH connection details
hostname = 'example.com'
username = 'your_username'
password = 'your_password'  # Replace with your actual password
directory_to_enter = 'ora'  # The directory you want to enter

# Function to recursively list directories
def list_directories(ssh_client, current_directory):
    # Send the command to list files and directories in the current directory
    ssh_shell.send(f'cd {current_directory}\n')
    ssh_shell.send('ls -l\n')

    # Wait for the command to execute
    while not ssh_shell.recv_ready():
        pass

    # Read and print the output of the command
    output = ssh_shell.recv(65535).decode()
    print(f"Contents of '{current_directory}' directory:\n{output}")

    # Find directories in the output and recursively list their contents
    for line in output.splitlines():
        if line.startswith('d'):
            subdir_name = line.split()[-1]
            list_directories(ssh_client, f"{current_directory}/{subdir_name}")

# Create an SSH client instance
ssh_client = paramiko.SSHClient()
ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

try:
    # Connect to the SSH server using password authentication
    ssh_client.connect(hostname=hostname, username=username, password=password)

    # Create an interactive shell session
    ssh_shell = ssh_client.invoke_shell()

    # Call the function to list directories recursively starting from 'ora'
    list_directories(ssh_client, directory_to_enter)

finally:
    # Close the SSH connection
    ssh_client.close()
