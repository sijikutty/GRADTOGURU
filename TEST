Browser("Browser").Page("Data Migration Workbench").Frame("TargetContent_3").WebButton("Refresh").Click

Dim run_status
run_status = Browser("Browser").Page("Data Migration Workbench").Frame("TargetContent_3").WebElement("PMN_PRCSLIST_RUNSTATUSDESCR$0").GetROProperty("innertext")

' Wait for Run status to be Success/Not Success/Warning/Error for approx 10 min.
Dim retry
retry = 0
Dim expected_values
expected_values = Array("Success", "Error", "Warning", "No Success")

Dim isStatusValid
isStatusValid = False

Do While retry < 600
    run_status = Browser("Browser").Page("Data Migration Workbench").Frame("TargetContent_3").WebElement("PMN_PRCSLIST_RUNSTATUSDESCR$0").GetROProperty("innertext")

    ' Check if run_status is one of the expected values
    For Each expected_status In expected_values
        If run_status = expected_status Then
            isStatusValid = True
            Exit For
        End If
    Next

    If isStatusValid Then
        Exit Do
    Else
        Browser("Browser").Page("Data Migration Workbench").Frame("TargetContent_3").WebButton("Refresh").Click
        retry = retry + 1
        Wait(1) ' Optional wait to avoid rapid clicking
    End If
Loop

If LCase(run_status) <> "success" Then
    Err.Raise vbObjectError + 9999, "Process Status: " & run_status
End If
