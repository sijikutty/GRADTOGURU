' RallyIntegration.vbs

' Function to update test case result in Rally
Function UpdateRallyTestCaseResult(testCaseID, verdict, comments)
    ' Construct Rally API URL
    rallyURL = "https://rally1.rallydev.com/slm/webservice/v2.0/testcaseresult"
    
    ' Construct HTTP request headers
    Set objHTTP = CreateObject("WinHttp.WinHttpRequest.5.1")
    objHTTP.Open "POST", rallyURL, False
    objHTTP.setRequestHeader "ZSESSIONID", "your_api_key"
    objHTTP.setRequestHeader "Content-Type", "application/json"
    
    ' Construct JSON payload
    payload = "{""TestCase"": """ & testCaseID & """, ""Verdict"": """ & verdict & """, ""Notes"": """ & comments & """}"
    
    ' Send HTTP request
    objHTTP.send payload
    
    ' Check response status
    If objHTTP.status = 200 Then
        UpdateRallyTestCaseResult = True
    Else
        UpdateRallyTestCaseResult = False
    End If
End Function
