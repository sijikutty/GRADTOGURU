from playwright.sync_api import sync_playwright

def run(playwright):
    browser = playwright.chromium.launch(headless=False)
    page = browser.new_page()

    # Step 1: Navigate to the main page
    page.goto("https://example.com")

    # Step 2: Open the first popup using get_by_role
    first_popup = page.expect_popup(
        lambda: page.get_by_role("button", name="Open First Popup").click()
    )

    # Step 3: Open the second popup from the first popup
    second_popup = first_popup.expect_popup(
        lambda: first_popup.get_by_role("button", name="Open Second Popup").click()
    )

    # Now you can interact with the second popup
    second_popup.get_by_role("textbox").fill("Some text")
    second_popup.get_by_role("button", name="Submit").click()

    # Clean up: Close the popups
    first_popup.close()
    second_popup.close()
    browser.close()

with sync_playwright() as playwright:
    run(playwright)
