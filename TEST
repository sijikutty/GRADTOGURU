Browser("Browser").Page("Data Migration Workbench").Frame("TargetContent_3").WebButton("Refresh").Click

Dim run_status
run_status = Browser("Browser").Page("Data Migration Workbench").Frame("TargetContent_3").WebElement("PMN_PRCSLIST_RUNSTATUSDESCR$0").GetROProperty("innertext")

' Wait for Run status to be Success/Not Success/Warning/Error for approx 10 min.
Dim retry
retry = 0
Dim expected_values
expected_values = Array("Success", "Error", "Warning", "No Success")

Do While retry < 600
    run_status = Browser("Browser").Page("Data Migration Workbench").Frame("TargetContent_3").WebElement("PMN_PRCSLIST_RUNSTATUSDESCR$0").GetROProperty("innertext")

    If Not IsError(Application.Match(run_status, expected_values, 0)) Then
        Exit Do
    Else
        Browser("Browser").Page("Data Migration Workbench").Frame("TargetContent_3").WebButton("Refresh").Click
        retry = retry + 1
        Wait(1) ' Optional wait to avoid rapid clicking
    End If
Loop

If LCase(run_status) <> "success" Then
    Err.Raise vbObjectError + 9999, "Process Status: " & run_status
End If
