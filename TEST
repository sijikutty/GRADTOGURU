from playwright.sync_api import Page
from automation_utils import get_testdata
from ps_utils import navigate_menu
import pytest 
import time
from Common_function import jrnl_post

@pytest.mark.parametrize("testcase", get_testdata("test_Journal_ID_Ref_Onl"))
def test_Journal_ID_Ref_Onl(page:Page,  testcase):

    testdata = testcase["testdata"]
    navigate_menu(page=page,
                  menu_sequence=["Set Up Financials/Supply Chain", 
                                 "Common Definitions", 
                                 "User Preferences", 
                                 "Define User Preferences"])
    targetContentFrame = page.frame_locator("iframe[name=\"TargetContent\"]")
    targetContentFrame.get_by_label("User ID").fill(testdata['userid'])
    targetContentFrame.get_by_role("cell", name="Search", exact=True).locator("a").click()
    targetContentFrame.get_by_role("link", name="General Ledger").click()
    targetContentFrame.get_by_label("Enable Online Journal Post").check()
    targetContentFrame.get_by_role("button", name="Save").click()
    jrnl_post(page,  testdata)
