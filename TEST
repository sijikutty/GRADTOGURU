Dim jsonUtil, jsonFilePath, jsonData, jsonObject, testScenario, testcase, server, Sheet_name

' File path to the JSON file
jsonFilePath = "C:\path\to\testcases.json"

' Test scenario name
testScenario = "test_load_Journal"

' Create JSONUtil object
Set jsonUtil = CreateObject("Mercury.JsonUtil")

' Read JSON data from file
jsonData = jsonUtil.ReadFile(jsonFilePath)

' Parse JSON data
Set jsonObject = jsonUtil.ParseJson(jsonData)

' Iterate over the testcases array to find the matching scenario
For Each testcase In jsonObject("testcases")
    If testcase("scenario") = testScenario Then
        ' Found the matching test scenario
        server = testcase("testdata")("server")
        Sheet_name = testcase("testdata")("Sheet_name")
        
        ' Do something with the fetched values
        MsgBox "Server: " & server & vbCrLf & "Sheet Name: " & Sheet_name
        
        Exit For ' Exit the loop once found
    End If
Next
