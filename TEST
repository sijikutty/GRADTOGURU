from playwright.sync_api import Page
from automation_utils import get_testdata
from ps_utils import navigate_menu
import pytest 
import time
from Common_function import jrnl_edit

@pytest.mark.parametrize("testcase", get_testdata("test_approval_workflow"))
def test_approval_workflow(page:Page,  testcase):

    testdata = testcase["testdata"]
    journal_id=jrnl_edit(page,  testdata)

    targetContentFrame = page.frame_locator("iframe[name=\"TargetContent\"]")

    targetContentFrame.get_by_label("Process").select_option("S")
    targetContentFrame.get_by_role("button", name="Process").click()

    print(journal_id) 
    targetContentFrame.get_by_label("Approval").click()
    Status=targetContentFrame.locator("[id=\"PSXLATITEM_XLATLONGNAME\\$0\"]").inner_text()
    print(Status)
    if Status=="Pending Approval":
        print("Approval initiated successfully")
    else:
        raise Exception(f"Approval framework issue")
