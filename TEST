from playwright.sync_api import Page, expect
from automation_utils import get_testdata, get_secrets,update_remote_file,autosys_job_run,connect_to_oracleDB,execute_query
import pytest
import paramiko


@pytest.mark.parametrize("testcase", get_testdata("test_Maximis_regression"))
def test_Maximis_regression(page: Page, testcase):
    testdata = testcase["testdata"]
    
    secrets = get_secrets(testdata["ods_unix_secretID"])

    hostname = testdata["odsserver"]
    username = secrets['User']
    password = secrets['Password']

    search_path = testdata["search_path"]
    file_to_edit = testdata["file_to_edit"]
    new_content = testdata["new_content"]

    #ODS Unix File modification
    try:
        update_remote_file(hostname, username, password, search_path, file_to_edit, new_content)
        print("ODS Maximis File Update successful.")
    except RuntimeError as e:
        print(f"Error occurred: {str(e)}")
