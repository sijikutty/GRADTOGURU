import os
import time
from pywinauto import Application

# Open File Explorer
explorer_path = r"C:\Users\SM05698\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar\File Explorer (2).lnk"
os.startfile(explorer_path)
time.sleep(2)  # Wait for File Explorer to open

# Connect to File Explorer window
explorer_app = Application(backend="uia").connect(title="File Explorer")

# Navigate to Downloads in File Explorer
file_explorer_window = explorer_app.window(title="File Explorer")
file_explorer_window.set_focus()
file_explorer_window.TreeView.get_item(r"Quick access\Downloads").click_input(double=True)
time.sleep(2)

# Activate Excel Window
excel_app = Application(backend="uia").connect(title="Excel_2")
excel_window = excel_app.window(title="Excel_2")
excel_window.set_focus()
time.sleep(1)

# Select Add-ins tab in Excel
excel_window.child_window(title="Ribbon Tabs").tabctrl.select("Add-ins")
time.sleep(1)

# Click on nVisionDrill button
excel_window.child_window(title="LFSTTB01_Life_STTB-HLA_2024-04-19").click_input()
time.sleep(1)

# Select Drill from menu
excel_window.child_window(title="WinMenu").menu_select("Drill")

# Note: Adjust the sleep times as necessary based on your application's responsiveness.
