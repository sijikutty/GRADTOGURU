' Enable error handling to prevent script halting on errors
On Error Resume Next

' Close existing instances of Microsoft Edge and Java Platform Launcher
SystemUtil.CloseProcessByName("msedge.exe")
SystemUtil.CloseProcessByName("jp2launcher.exe")

' Run Microsoft Edge browser
SystemUtil.Run "msedge.exe"

' Navigate to the specified URL
Browser("iConnect - Home").Navigate "http://p2808hldebz002.thehartford.com:8005/OA_HTML/AppsLocalLogin.jsp"

' Set username and password
Browser("iConnect - Home").Page("Login").WebEdit("usernameField").Set "fitauto"
Browser("iConnect - Home").Page("Login").WebEdit("passwordField").Set "Mango@2025"

' Click on the Log In button
Browser("iConnect - Home").Page("Login").WebButton("Log In").Click

' Click on the "XXHIG Custom" link
Browser("Home").Page("Home").Link("XXHIG Custom").Click

' Click on the "Run Requests" link
Browser("Home").Page("Home").Link("Run Requests").Click

' Check if the Security Warning dialog exists
If JavaDialog("Security Warning").Exist(10) Then
    ' If it exists, set the checkbox and click on the Run button
    JavaDialog("Security Warning").JavaCheckBox("I accept the risk and").Set "ON"
    JavaDialog("Security Warning").JavaButton("Run").Click
End If

' Click on the OK button in the "Submit a New Request" form
OracleFormWindow("Submit a New Request").OracleButton("OK").Click

' Open the dialog for selecting a report
OracleFormWindow("Submit Request").OracleTextField("Run this Request|Name").OpenDialog

' Select the "HIG Basic Validation Report" from the list of values
OracleListOfValues("Reports").Select "HIG Basic Validation Report"

' Open the dialog for selecting the source
OracleFlexWindow("Parameters").OracleTextField("Source").OpenDialog

' Select "BAC" as the source from the list of values
OracleListOfValues("Source").Select "BAC"

' Enter the request ID
OracleFlexWindow("Parameters").OracleTextField("Request Id").Enter "456"

' Click on the "Approve" button
OracleFlexWindow("Parameters").Approve

' Click on the "Submit" button in the "Submit Request" form
OracleFormWindow("Submit Request").OracleButton("Submit").Click

' Decline the Oracle notification with the title "Decision"
OracleNotification("Decision").Decline

' Click on the "Open" button in the "Navigator" form
OracleFormWindow("Navigator").OracleButton("Open").Click

' Click on the "Find" button in the "Find Requests" form
OracleFormWindow("Find Requests").OracleButton("Find").Click

' Click on the "View Details" button in the "Requests" form
OracleFormWindow("Requests").OracleButton("View Details").Click

' Click on the "OK" button in the "Request Detail" form
OracleFormWindow("Request Detail").OracleButton("OK").Click

' Close the Java window with the title "Oracle Applications -"
JavaWindow("Oracle Applications -").Close

' Disable error reporting temporarily
On Error Resume Next

' Disable reporting temporarily
Reporter.Filter = rfDisableAll

' Approve the Oracle notification with the title "Caution"
OracleNotification("Caution").Approve

' Enable reporting
Reporter.Filter = rfEnableAll

' Reset error handling
On Error GoTo 0

' Close the Microsoft Edge browser
Browser("iConnect - Home").Close

' Check if an error occurred
If Err.Number <> 0 Then
    ' If there was an error, close UFT application if it is still open
    If Not SystemUtil.CloseProcessByName("UFT.exe") Then
        ' Display error message if failed to close UFT
        MsgBox "Failed to close UFT application!"
    End If
End If

' Check if UFT error popup exists
If Dialog("Error Popup").Exist(10) Then
    ' Fetch error details from the popup
    errorDetails = Dialog("Error Popup").GetROProperty("Text")
    
    ' Display error details in a message box
    MsgBox "Error occurred: " & errorDetails
    
    ' Close the error popup
    Dialog("Error Popup").Close
End If

' Clear any remaining errors
Err.Clear
