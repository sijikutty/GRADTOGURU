' Get the current date and time
current_datetime = Now

' Format the date and time to a string
formatted_datetime = Year(current_datetime) & "-" & Right("0" & Month(current_datetime), 2) & "-" & Right("0" & Day(current_datetime), 2) & "T" & Right("0" & Hour(current_datetime), 2) & ":" & Right("0" & Minute(current_datetime), 2) & ":" & Right("0" & Second(current_datetime), 2)

' Get the microseconds part
microseconds = Right(FormatNumber((current_datetime - Int(current_datetime)) * 1000000, 6), 6)

' Concatenate microseconds to the formatted string
formatted_datetime_with_microseconds = formatted_datetime & "." & microseconds

' Display the formatted date and time with microseconds
MsgBox formatted_datetime_with_microseconds
