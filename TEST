import os
import win32com.client

# Function to open Excel file from the Downloads folder
def open_excel():
    download_folder = os.path.expanduser("~/Downloads")  # Assuming the Downloads folder is used
    excel_file_path = os.path.join(download_folder, "vv.xlsm")
    xl = win32com.client.Dispatch("Excel.Application")
    xl.Visible = True
    
    # Enable add-ins to load on startup
    xl.Application.AddIns2("drill").Installed = True  # Assuming 'drill' is the name of the add-in
    
    workbook = xl.Workbooks.Open(excel_file_path)
    return xl, workbook

# Main function to execute the steps
def main():
    xl, workbook = open_excel()

if __name__ == "__main__":
    main()
