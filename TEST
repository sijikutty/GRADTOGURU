' Define paths and arguments
pythonExePath = "C:\Program Files\Python311\python.exe"
scriptPath = "C:\Github\corp_corpit_ps_egl_test_automation\smoketest\test_gui\uploadtos3.py"
filePath = "C:\Github\corp_corpit_ps_egl_test_automation\UFT\rallydata.json"
s3bucket = "app-5208-dev-ue1-shared-s3-1"
s3filename = "Testing/rallyinput/rally_tc_results.json"

' Construct the command to execute the Python script with arguments
command = """" & pythonExePath & """ """ & scriptPath & """ """ & filePath & """ """ & s3bucket & """ """ & s3filename & """"

' Run the command using SystemUtil.Run
Dim WshShell, oExec, output, errorOutput, returnCode
Set WshShell = CreateObject("WScript.Shell")
Set oExec = WshShell.Exec("cmd /c " & command)

' Read the output and error output
output = oExec.StdOut.ReadAll()
errorOutput = oExec.StdErr.ReadAll()
returnCode = oExec.ExitCode

' Check return code and display messages
If returnCode <> 0 Then
    MsgBox "Python script failed with return code: " & returnCode & vbCrLf & _
           "Standard Output:" & vbCrLf & output & vbCrLf & _
           "Standard Error Output:" & vbCrLf & errorOutput
Else
    MsgBox "Python script executed successfully." & vbCrLf & _
           "Standard Output:" & vbCrLf & output
End If
