Dim fs, jsonFile, jsonData, jsonObject

' File path to the JSON file
jsonFilePath = "C:\path\to\testcases.json"

' Test scenario name
testScenario = "test_load_Journal"

' Create FileSystemObject
Set fs = CreateObject("Scripting.FileSystemObject")

' Open the JSON file for reading
Set jsonFile = fs.OpenTextFile(jsonFilePath)

' Read the JSON content
jsonData = jsonFile.ReadAll

' Close the JSON file
jsonFile.Close

' Convert JSON string to a dictionary object
Set jsonObject = JSONParse(jsonData)

' Iterate over the testcases array to find the matching scenario
For Each testcase In jsonObject("testcases")
    If testcase("scenario") = testScenario Then
        ' Found the matching test scenario
        server = testcase("testdata")("server")
        Sheet_name = testcase("testdata")("Sheet_name")
        
        ' Do something with the fetched values
        MsgBox "Server: " & server & vbCrLf & "Sheet Name: " & Sheet_name
        
        Exit For ' Exit the loop once found
    End If
Next

Function JSONParse(jsonString)
    Dim objJSON
    Set objJSON = CreateObject("Scripting.Dictionary")
    With CreateObject("MSScriptControl.ScriptControl")
        .Language = "JScript"
        .AddCode "function parse(json) {return JSON.parse(json);}"
        Set objJSON = .Run("parse", jsonString)
    End With
    Set JSONParse = objJSON
End Function
