from playwright.sync_api import sync_playwright

def run(playwright):
    browser = playwright.chromium.launch()
    page = browser.new_page()

    # Navigate to your target URL
    page.goto('http://your-url-here')

    # Wait for the popup to appear
    page.wait_for_selector('#win0divPSTOOLBAR', timeout=5000)  # Adjust the timeout as needed

    # Interact with the popup elements
    # Assuming 'PRCSRQSTDLG_WRK_SERVERNAME' is an input or dropdown in the popup
    page.fill('input[name="PRCSRQSTDLG_WRK_SERVERNAME"]', 'PSUNX')  # Change to select_option if it's a dropdown

    # Click the OK button
    page.click("input[id='#ICSave']")

    # Optionally wait for a response or new page
    page.wait_for_timeout(1000)  # Adjust as necessary

    # Close the browser
    browser.close()

with sync_playwright() as playwright:
    run(playwright)
