from openpyxl import load_workbook
from zipfile import ZipFile
import xml.etree.ElementTree as ET

# Load the Excel file
workbook = load_workbook('example.xlsx')

# Function to check if outlining exists
def check_outlining(worksheet_name):
    sheet_path = f'xl/worksheets/{worksheet_name}.xml'
    with ZipFile('example.xlsx') as zip:
        with zip.open(sheet_path) as xml_file:
            root = ET.parse(xml_file).getroot()
            for node in root.iter():
                if 'outlineLevel' in node.tag:
                    return True
    return False

# Function to check if data grouping exists
def check_data_grouping(worksheet_name):
    sheet_path = f'xl/worksheets/{worksheet_name}.xml'
    with ZipFile('example.xlsx') as zip:
        with zip.open(sheet_path) as xml_file:
            root = ET.parse(xml_file).getroot()
            for node in root.iter():
                if 'outlineLevel' in node.tag:
                    return True
    return False

# Check if outlining exists in the Excel file
if check_outlining('Sheet1'):
    print("Outlining exists in the Excel file")
else:
    print("Outlining does not exist in the Excel file")

# Check if data grouping exists in the Excel file
if check_data_grouping('Sheet1'):
    print("Data grouping exists in the Excel file")
else:
    print("Data grouping does not exist in the Excel file")
