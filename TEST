from openpyxl import load_workbook

# Function to check if data grouping exists in a specific worksheet
def check_data_grouping(worksheet_name):
    workbook = load_workbook('example.xlsx')
    worksheet = workbook[worksheet_name]
    for row in worksheet.iter_rows(min_row=1, max_row=1):
        for cell in row:
            if cell.row_hidden:
                return True  # If any row is hidden, data grouping is likely applied
    for column in worksheet.iter_cols(min_col=1, max_col=1):
        for cell in column:
            if cell.column_hidden:
                return True  # If any column is hidden, data grouping is likely applied
    return False

# Specify the sheet in which to check for grouping
target_sheet_name = 'Sheet1'

# Check if data grouping exists in the specified sheet
if check_data_grouping(target_sheet_name):
    print(f"Data grouping exists in {target_sheet_name}")
else:
    print(f"No data grouping in {target_sheet_name}")
