=TRIM(TEXTJOIN("", TRUE, IF(ISNUMBER(FIND(MID(MID(A1, SEARCH("TE_", A1) + 3, LEN(A1) - SEARCH("TE_", A1) - 2), ROW(INDIRECT("1:" & LEN(MID(A1, SEARCH("TE_", A1) + 3, LEN(A1) - SEARCH("TE_", A1) - 2)))), 1)), UPPER(MID(MID(A1, SEARCH("TE_", A1) + 3, LEN(A1) - SEARCH("TE_", A1) - 2), ROW(INDIRECT("1:" & LEN(MID(A1, SEARCH("TE_", A1) + 3, LEN(A1) - SEARCH("TE_", A1) - 2)))), 1))))), " ", MID(MID(A1, SEARCH("TE_", A1) + 3, LEN(A1) - SEARCH("TE_", A1) - 2), ROW(INDIRECT("1:" & LEN(MID(A1, SEARCH("TE_", A1) + 3, LEN(A1) - SEARCH("TE_", A1) - 2)))), 1))))
