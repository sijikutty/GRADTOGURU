' Create a FileSystemObject
Dim fso
Set fso = CreateObject("Scripting.FileSystemObject")

' Replace "path_to_your_credentials_file\credentials.json" with the actual path to your credentials JSON file
Dim jsonFilePath
jsonFilePath = "path_to_your_credentials_file\credentials.json"

' Check if the JSON file exists
If fso.FileExists(jsonFilePath) Then
    ' Open the JSON file
    Dim jsonFile
    Set jsonFile = fso.OpenTextFile(jsonFilePath, 1) ' 1 for reading

    ' Read the contents of the JSON file
    Dim jsonContents
    jsonContents = jsonFile.ReadAll()

    ' Close the JSON file
    jsonFile.Close()

    ' Parse the JSON string
    Dim parsedJson
    Set parsedJson = JsonUtil.Parse(jsonContents)

    ' Check if the parsed JSON object is valid and contains the expected keys
    If IsObject(parsedJson) Then
        If parsedJson.Exists("username") And parsedJson.Exists("password") Then
            ' Extract username and password
            Dim username, password
            username = parsedJson("username")
            password = parsedJson("password")

            ' Display the username and password
            MsgBox "Username: " & username & vbCrLf & "Password: " & password
        Else
            MsgBox "Error: Invalid JSON structure. 'username' and 'password' keys not found."
        End If
    Else
        MsgBox "Error: Invalid JSON content."
    End If
Else
    MsgBox "Error: JSON file not found."
End If

' Release the FileSystemObject
Set fso = Nothing
