import win32com.client

def open_excel_and_select_addin():
    xl = win32com.client.Dispatch("Excel.Application")
    xl.Visible = True
    
    xlWB = xl.Workbooks.Open(r"C:\path\to\your\file.xlsx")  # Replace with the path to your Excel file
    
    # Access the Developer tab
    xl.Application.ExecuteExcel4Macro("Show.Toolbar(""Ribbon"", True)")
    
    # Navigate to Add-Ins option in the ribbon menu bar
    xl.Application.SendKeys("%{tj}") # Access Developer tab
    xl.Application.SendKeys("i") # Select Add-ins option
    xl.Application.SendKeys("a") # Select Add-ins dialog
    xl.Application.SendKeys("{ENTER}") # Confirm the selection
    
    # Select the dropdown of the 'drill' add-in and click on it
    xl.Application.SendKeys("drill")
    xl.Application.SendKeys("%(v)")

if __name__ == "__main__":
    open_excel_and_select_addin()
